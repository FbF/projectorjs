{"name":"Projectorjs","tagline":"A small no-dependencies JavaScript library that enables the display of overlays on native HTML5 video elements, or (optionally) video elements powered by videojs. ","body":"# Projector.js\r\n\r\nA small no-dependencies JavaScript library that enables the display of overlays on native HTML5 video elements, or (optionally) video elements powered by [videojs](https://github.com/videojs/video.js/). Overlays can be triggered via time ranges or events. A set of useful overlays is (WIP) included to cover common use cases.\r\n\r\n## Getting Started\r\n### Raw browser\r\n\r\nYou need to include both the javascript and css files from the project. Both of these are located in the dist directory.\r\n\r\n```html\r\n<head>\r\n    <script src=\"projector.min.js\"></script>\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../dist/css/projector-js.min.css\">\r\n</head>\r\n<body>\r\n    <video id=\"video\" controls>\r\n        <source src=\"video.webm\" type=\"video/webm\">\r\n    </video>\r\n    <script>\r\n    var v = Projector.init('video');\r\n    v.addOverlay(\r\n        Projector.TextBox({text: \"Hello\"}),\r\n        {\r\n            top: '50%',\r\n            left: '50%',\r\n            timings: [\r\n                {\r\n                    timing:'0-10,15-20'\r\n                }\r\n            ]\r\n        }\r\n    )\r\n    </script>\r\n</body>\r\n```\r\n\r\nOr you can use projector.js with videojs:\r\n\r\n```html\r\n<head>\r\n    <script src=\"video.js\"></script>\r\n    <link href=\"video-js.css\" rel=\"stylesheet\">\r\n    <script src=\"projector.min.js\"></script>\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../dist/css/projector-js.min.css\">\r\n</head>\r\n<body>\r\n    <video id=\"videojs-test\" controls>\r\n        <source src=\"video.webm\" type=\"video/webm\">\r\n    </video>\r\n    <script>\r\n    var v = videojs(\"videojs-test\").projector();\r\n    v.addOverlay(\r\n        Projector.TextBox({text: \"Hello\"}),\r\n        {\r\n            top: '50%',\r\n            left: '50%',\r\n            timings: [\r\n                {\r\n                    start: 5,\r\n                    end: 10\r\n                },\r\n                {\r\n                    start: 15,\r\n                    end: 20\r\n                }\r\n            ]\r\n        }\r\n    );\r\n    </script>\r\n</body>\r\n\r\n\r\n```\r\n\r\n### Other require libs\r\n\r\nProjector.js uses the [UMD](https://github.com/umdjs/umd) pattern and so should work with both [require.js](https://github.com/jrburke/requirejs) and [browserify](https://github.com/substack/node-browserify).\r\n\r\n## Considerations\r\n\r\n### Overlays block clicks\r\n\r\nA common issue with video overlays is that one overlay blocks events from hitting other overlays that are underneath. E.g, you have 2 overlays that both provide user input, but because one is on top, the other is not accessible.\r\n\r\nProjector.js attempts to counter this by assigning the [```pointer-events: none;```](https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events) CSS property to overlay wrappers (```.projector-overlay```). This allows child elements to be clickable, but the containing overlay div (which covers the whole video) allows events to \"pass-through.\" However, this is a new property and support is limited on older browsers. It is of note that it is unsupported on < IE11.\r\n\r\nA good way to avoid this issue is to keep all individual elements on a separate overlay. I.e. avoid having 2 separate divs in a single overlay. This would cause the overlay container to stretch to fit both, introducing transparent white space which would block clicks if on a browser that does not support pointer-events.\r\n\r\n### Scaling up videos\r\n\r\nIt is important to use percentage values for dimensions/margins/paddings if you want your overlay to scale up if the video size changes (I.e. full screen).\r\n\r\nProjector.js sets the font-size of the overlay wrappers to 1% of the width of the video. This should allow you to use em or percentage values for font-size. You could also use [viewport units](http://caniuse.com/#feat=viewport-units) if you don't care about older browsers.\r\n\r\n### Sub-second accuracy\r\n\r\nDifferent browsers report the time elapsed at different intervals. This unfortunately limits the use of milliseconds. Projector.js does not currently support milliseconds, but is being considered for inclusion in the library via setTimeout() hacks. Regardless, **exact** precision is not easily achievable and is out of scope.\r\n\r\n### Dirty triggers\r\n\r\nProjector.js ensures your overlay is active between the user-specified times. Consequentially, as the users elapsed video time breaches a user specified time period, the relevant overlay is triggered to be active.\r\n\r\nHowever, the user may have seeked directly into this time period, and not naturally watched the video in real time. For this reason, callbacks such as `beforeBeginOverlay` are passed a \"dirty\" flag when the user has seeked into one of the specified time ranges. This allows the developer to disable certain affects when the player is used in this way, e.g. fade in animations.\r\n\r\n## Core API\r\n\r\n### Projector object\r\n\r\nThe projector object provides the intialization function to allow projectorjs to attach to your video element.\r\n\r\n#### init(element, [options])\r\nType: `function`  \r\nArguments: `element<string|HTMLElement>`, `options<object>`  \r\nReturns: `pInstance`\r\n\r\n##### options\r\n\r\nInstead of using the `addOverlay` function of a `pInstance`, you can use the shorthand method to specify all of your overlays in the initial options object. Please see the  [`addOverlay`](#addOverlay)  documentation for full description of options.\r\n\r\n\r\n```javascript\r\nvar p = Projector.init(document.getElementById('video'), {\r\n    overlays: [\r\n        {\r\n            overlay: Projector.TextBox({text: \"Test\"}),\r\n            left:'40%',\r\n            top: '50%',\r\n            timings: [\r\n                {\r\n                    timing: '8-14'\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n});\r\n\r\n// Add more overlays programmatically\r\np.addOverlay(...)\r\n```\r\n\r\nInit can also be called via video.js intialization.\r\n\r\n```javascript\r\nvar p = videojs(\"video\").projector({\r\n    // Options\r\n    ...\r\n});\r\n\r\n// Add more overlays programmatically\r\np.addOverlay(...)\r\n```\r\n\r\n### pInstance object\r\n\r\nThe pInstance (projector instance) object is attached to a single HTML or videojs video element. It exposes functions to attach overlays.\r\n\r\n#### addOverlay\r\nType: `function`  \r\nArguments: `overlay<Overlay>`, `options<object>`  \r\nReturns: `pInstance`\r\n\r\nAttach an overlay object (see [Bundled overlays](#bundled-overlays)) with the given options.\r\n\r\n##### Options\r\n\r\n###### left\r\nType: `string`  \r\nDefault: `undefined` (effectively auto)\r\n\r\nThe position of the overlay relative to the left boundary. Include units.\r\n\r\n###### right\r\nType: `string`  \r\nDefault: `undefined` (effectively auto)\r\n\r\nThe position of the overlay relative to the right boundary. Include units.\r\n\r\n###### top\r\nType: `string`  \r\nDefault: `undefined` (effectively auto)\r\n\r\nThe position of the overlay relative to the top boundary. Include units.\r\n\r\n###### bottom\r\nType: `string`  \r\nDefault: `undefined` (effectively auto)\r\n\r\nThe position of the overlay relative to the bottom boundary. Include units.\r\n\r\n###### height\r\nType: `string`  \r\nDefault: `undefined` (effectively auto)\r\n\r\nThe width of the overlay. Include units.\r\n\r\n###### width\r\nType: `string`  \r\nDefault: `undefined`\r\n\r\nThe height of the overlay. Include units.\r\n\r\n###### timings\r\nType: `array<timings>`  \r\nDefault: `[]`\r\n\r\nAn array of timing singleton objects. See [Timing object](#timing-object).\r\n\r\n### Timing object\r\n\r\nA user-provided singleton object passed as part of the options for `Projector.init` or `pInstance.addOverlay`.\r\n\r\n#### timing\r\nType: `string`  \r\nDefault: `undefined`  \r\nExample: `\"3-6,6-10,20\"`\r\n\r\nA shorthand string representing time periods for the start and end of overlays. This string is a comma separated list of\r\n\r\n* min/max integer ranges (seconds) delimited by hyphens.\r\n* or singular integers (seconds).\r\n\r\nIf a single integer 'x' is specified, this is processed as a timing that starts at 'x' seconds, with no end.\r\n\r\nOverrides start and end values if set.\r\n\r\n#### start\r\nType: `integer|string`  \r\nDefault: `undefined`\r\n\r\nThe number of seconds elapsed upon which the overlay starts. Alternatively, an event name such as play or pause. Any event fired on the video element (native or videojs) works.\r\n\r\n#### end\r\nType: `integer|string`  \r\nDefault: `undefined`\r\n\r\nThe number of seconds elapsed upon which the overlay ends. Alternatively, an event name such as play or pause. Any event fired on the video element (native or videojs) works.\r\n\r\n\r\n#### beforeBeginOverlay\r\nType: `function`  \r\nDefault: `undefined`  \r\nArguments: `overlay<Overlay>`, `currentTime<integer>`, `dirtyTrigger<boolean>`\r\n\r\nA callback called before the overlay begins. This function is passed the overlay object, the current time elapsed and a \"dirty trigger flag\" (see [Dirty triggers](#dirty-triggers)).\r\n\r\n#### afterBeginOverlay\r\nType: `function`  \r\nDefault: `undefined`  \r\nArguments: `overlay<Overlay>`, `currentTime<integer>`, `dirtyTrigger<boolean>`\r\n\r\nA callback called after the overlay begins. This function is passed the overlay object, the current time elapsed and a \"dirty trigger flag\" (see [Dirty triggers](#dirty-triggers)).\r\n\r\n#### beforeEndOverlay\r\nType: `function`  \r\nDefault: `undefined`  \r\nArguments: `overlay<Overlay>`, `currentTime<integer>`, `dirtyTrigger<boolean>`\r\n\r\nA callback called before the overlay ends. This function is passed the overlay object, the current time elapsed and a \"dirty trigger flag\" (see [Dirty triggers](#dirty-triggers)).\r\n\r\n#### afterEndOverlay\r\nType: `function`  \r\nDefault: `undefined`  \r\nArguments: `overlay<Overlay>`, `currentTime<integer>`, `dirtyTrigger<boolean>`\r\n\r\nA callback called after the overlay ends. This function is passed the overlay object, the current time elapsed and a \"dirty trigger flag\" (see [Dirty triggers](#dirty-triggers)).\r\n\r\n\r\n### Overlay object\r\n\r\nThe overlay object represents the overlay itself. [Built in overlays](#bundled-overlays) and custom overlays extend this object.\r\n\r\n#### init\r\nType: `function`\r\nArguments: `options<Object>`  \r\nReturns: `boolean`\r\n\r\nSets up the overlay. No need to call manually as is invoked upon overlay creation.\r\n\r\n```javascript\r\n// Creates overlay, calls init, and returns overlay object\r\nvar o = Projector.TextBox();\r\n```\r\n\r\n##### Options\r\n\r\n###### attrs\r\nType: `object`\r\n\r\nA set of attributes that you wish to be copied over to the styles of the overlay.\r\n\r\n```javascript\r\n// Creates overlay, calls init, and returns overlay object\r\nvar o = Projector.TextBox({\r\n    attrs: {\r\n        class: 'custom-class',\r\n        id: 'custom-id'\r\n    }\r\n});\r\n```\r\n#### render\r\nType: `function`  \r\nReturn: `HTMLElement`\r\n\r\nBuilds and returns the DOM element representing the overlay. Override in custom overlays.\r\n\r\n#### beginOverlay\r\nType: `function`  \r\nArguments: `cb<function>`, `curTime<integer>`, `dirty<boolean>`\r\n\r\nMain function to trigger the overlay \"on\". Default is to unhide DOM element. Override in custom overlays. Execute the callback when done.\r\n\r\n#### endOverlay\r\nType: `function`  \r\nArguments: `cb<function>`, `curTime<integer>`, `dirty<boolean>`\r\n\r\nMain function to trigger the overlay \"off\". Default is to hide DOM element. Override in custom overlays. Execute the callback when done.\r\n\r\n#### update\r\nType: `function`\r\nArguments: `curTime<integer>`, `dirty<boolean>`\r\n\r\nGiven an elapsed time in seconds and the dirty flag (see [Dirty triggers](#dirty-triggers)), check if the overlay should show (according to passed elapsed time). Can override in custom overlays if you wish to trigger your overlay on more complicated logic than time ranges. This function is called each time the \"timeupdate\" event is triggered on the video.\r\n\r\n#### isActive\r\nType: `function`  \r\nReturns: `boolean`\r\n\r\nReturns true if the overlay is in an active state.\r\n\r\n\r\n#### element\r\nType: `HTMLElement`\r\n\r\nThe HTMLElement representing the overlay.\r\n\r\n#### class\r\nType: `string`\r\n\r\nThe default class of an overlay. Override in custom overlays.\r\n\r\n\r\n## Bundled overlays\r\n\r\nProjector.js comes with some bundled overlays to cover the most common use cases (WIP).\r\n\r\n### Projector.TextBox(options)\r\n\r\n#### Options\r\n\r\n#####text\r\nType: `string`\r\n\r\nThe text to display in the text box.\r\n\r\n### Projector.HTMLBox(options)\r\n\r\n#### Options\r\n\r\n##### html\r\nType: `string|HTMLElement`\r\n\r\nThe text to display in the text box.\r\n\r\n\r\n## Building overlays\r\n\r\nExtend the `Projector.Overlay` object. Always call the super function within each method unless you know what you are doing. This example creates a text box overlay that fades in:\r\n\r\n```javascript\r\nvar TextBox = (function () {\r\n    var exports = function(options) {\r\n        var ret = Object.create(exports.prototype);\r\n        ret.init(options);\r\n        return ret;\r\n    };\r\n\r\n    exports.prototype = Object.create(Overlay.prototype);\r\n    exports.prototype.class = 'projector-textbox-fade';\r\n    exports.prototype.init = function() {\r\n        Overlay.prototype.init.apply(this, arguments);\r\n    };\r\n\r\n    exports.prototype.beginOverlay = function(cb) {\r\n        Overlay.prototype.beginOverlay.apply(this, arguments);\r\n        $(this.element).fadeIn();\r\n    };\r\n\r\n    exports.prototype.endOverlay = function(cb) {\r\n        Overlay.prototype.endOverlay.apply(this, arguments);\r\n        $(this.element).fadeOut();\r\n    };\r\n\r\n    exports.prototype.render = function() {\r\n        var div = Overlay.prototype.render.call(this);\r\n        div.innerHTML = this.options.text;\r\n        return div;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n```\r\n\r\n## Build\r\n\r\nTo build, use [gulp](https://github.com/gulpjs/gulp/) and simply run `gulp` in the project root.\r\n\r\n## Release History\r\n- 0.1.0: Initial release\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}